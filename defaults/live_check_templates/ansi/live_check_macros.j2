{% macro display_statistics(statistics) %}
{{ ("Attribute samples") | ansi_blue | ansi_bold }}
  - total: {{ statistics.total_attributes }}
  - no advice: {{ statistics.no_advice_count }}
{% for key, value in statistics.highest_advice_level_counts.items() %}
  - {{ key }}: {{ value }}
{% endfor %}

{{ ("Advisories given") | ansi_blue | ansi_bold }}
  - total: {{ statistics.total_advisories }}
{%- if statistics.total_advisories > 0 %}  
  - advice level:
{% for key, value in statistics.advice_level_counts.items() %}
    - {{ key }}: {{ value }}
{% endfor %}
  - advice type:
{% for key, value in statistics.advice_type_counts.items() %}
    - {{ key }}: {{ value }}
{% endfor %}
{% endif %}

{{ ("Registry coverage") | ansi_blue | ansi_bold }}
  - attributes seen: {{ (statistics.registry_coverage * 100) | round(2) }}%
{% endmacro %}

{% macro display_advice(all_advice, indent=0) %}
  {% for advice in all_advice %}
    {% if advice.advice_level == "information" %}
{{ " " * indent }}    - {{ advice.advice_type ~ ": " ~ (advice.value) | ansi_green }} - {{ advice.message }}
    {% elif advice.advice_level == "improvement" %}
{{ " " * indent }}    - {{ advice.advice_type ~ ": " ~ (advice.value) | ansi_yellow }} - {{ advice.message }}
    {% else %}
{{ " " * indent }}    - {{ advice.advice_type ~ ": " ~ (advice.value) | ansi_red }} - {{ advice.message }}
    {% endif %}
  {% endfor %}
{% endmacro %}

{% macro display_attribute(attribute, indent=0) %}
{% set highest_advice_level = attribute.live_check_result.highest_advice_level %}
{%- if highest_advice_level == "information" or not highest_advice_level %}
{{ " " * indent }}{{ attribute.name | ansi_bright_green }}{% if attribute.value %} = {{ attribute.value }}{% endif %}
{%- elif highest_advice_level == "improvement" %}
{{ " " * indent }}{{ attribute.name | ansi_bright_yellow }}{% if attribute.value %} = {{ attribute.value }}{% endif %}
{%- else %}
{{ " " * indent }}{{ attribute.name | ansi_bright_red }}{% if attribute.value %} = {{ attribute.value }}{% endif %}
{%- endif %}

{{ display_advice(attribute.live_check_result.all_advice, indent)}}
{%- endmacro -%}

{% macro display_span_event(span_event, indent=0) %}
{{ " " * indent }}{{ ("Span event") | ansi_bright_cyan | ansi_bold }} name: {{ span_event.name | ansi_green }}
{{ display_advice(span_event.live_check_result.all_advice, indent) }}
{%- for attribute in span_event.attributes %}
{{ display_attribute(attribute, indent + 4) }}
{%- endfor %}
{% endmacro %}

{% macro display_span_link(span_link, indent=0) %}
{{ " " * indent }}{{ ("Span link") | ansi_bright_cyan | ansi_bold }}
{{ display_advice(span_link.live_check_result.all_advice, indent) }}
{%- for attribute in span_link.attributes %}
{{ display_attribute(attribute, indent + 4) }}
{%- endfor %}
{% endmacro %}

{% macro display_resource(resource, indent=0) %}
{{ " " * indent }}{{ ("Resource") | ansi_bright_cyan | ansi_bold }}
{{ display_advice(resource.live_check_result.all_advice, indent) }}
{%- for attribute in resource.attributes %}
{{ display_attribute(attribute, indent + 4) }}
{%- endfor %}
{% endmacro %}

{%- macro display_sample(sample, indent=0) -%}
{%- if sample.span is defined -%}
{{ " " * indent }}{{ ("Span") | ansi_bright_cyan | ansi_bold }} name: {{ sample.span.name | ansi_green }} kind: {{ sample.span.kind | ansi_green }}
{{ display_advice(sample.span.live_check_result.all_advice, indent) }}
{%- for attribute in sample.span.attributes %}
{{ display_attribute(attribute, indent + 4) }}
{%- endfor %}
{% for span_event in sample.span.span_events %}
{{ display_span_event(span_event, indent + 4) }}
{%- endfor %}
{% for span_link in sample.span.span_links %}
{{ display_span_link(span_link, indent + 4) }}
{%- endfor %}
{%- elif sample.attribute is defined -%}
{{ display_attribute(sample.attribute, indent) }}
{%- elif sample.span_event is defined -%}
{{ display_span_event(sample.span_event, indent) }}
{%- elif sample.span_link is defined -%}
{{ display_span_link(sample.span_link, indent) }}
{%- elif sample.resource is defined -%}
{{ display_resource(sample.resource, indent) }}
{%- endif -%}
{%- endmacro -%}